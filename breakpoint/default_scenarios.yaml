# ==========================================
# BREAKPOINT ELITE SCENARIOS (FULL SPECTRUM)
# ==========================================
# Modes:
# - Normal: Standard vulnerability checks (Non-destructive)
# - Aggressive: Destructive payloads, Higher concurrency, Crashing (Use --aggressive CLI flag)
# ==========================================

# --- 1. RECONNAISSANCE & MISCONFIGURATION ---
- id: check_security_headers
  type: header_security
  target: /
  method: GET

- id: check_open_redirect
  type: open_redirect
  target: /redirect
  method: GET
  config: {fields: [url, next, returnTo, callback, undo]}

- id: check_debug_exposure
  type: debug_exposure
  target: /
  method: GET

- id: check_secret_leak
  type: secret_leak
  target: /
  method: GET

# --- 2. IDENTIFICATION & AUTHENTICATION ---
- id: brute_force_login
  type: brute_force
  target: /login
  method: POST
  config: 
    user: admin
    # Aggressive Mode triggers: Large dictionary & Buffer Overflows

- id: jwt_none_algo_attack
  type: jwt_weakness
  target: /api/user
  method: GET
  config: {token: "{{token}}"} 
  # Note: Requires a captured token. If missing, this test skips safely.

# --- 3. INJECTION (THE HEAVY HITTERS) ---
- id: sql_injection_login
  type: sql_injection
  target: /login
  method: POST
  config: 
    fields: [username, password, email]
    # Aggressive Mode triggers: DROP TABLE, TRUNCATE, xp_cmdshell

- id: xss_reflected_search
  type: xss
  target: /search
  method: GET
  config: {fields: [q, query, search, keyword]}

- id: crlf_injection_headers
  type: crlf_injection
  target: /
  method: GET
  config: {fields: [lang, url]}
  
- id: command_injection_rce
  type: rce
  target: /api/ping
  method: POST
  config: {fields: [ip, host, domain, target]}

- id: xxe_xml_injection
  type: xxe_exfil
  target: /api/xml
  method: POST

- id: ssti_template_injection
  type: ssti
  target: /template
  method: GET
  config: {fields: [name, template, text]}
  
- id: insecure_deserialization
  type: insecure_deserialization
  target: /
  method: GET
  # Checks Cookies for Java/Python serialized objects

# --- 4. BROKEN ACCESS CONTROL ---
- id: idor_check
  type: idor
  target: /api/users/{{id}}
  method: GET
  config: {test_ids: [1, 2, 3, 100, 101, 999]}

- id: lfi_path_traversal
  type: lfi
  target: /download
  method: GET
  config: {fields: [file, path, doc, view]}

# --- 5. VULNERABLE COMPONENTS (CVEs) ---
- id: log4shell_check
  type: log4shell
  target: /
  method: GET
  # Aggressive Mode triggers: Remote Shell Execution attempts

- id: spring4shell_check
  type: spring4shell
  target: /
  method: POST
  # Attempts to drop a webshell

- id: struts2_rce_check
  type: struts2_rce
  target: /
  method: GET

# --- 6. LOGIC & BUSINESS FLAWS ---
- id: race_condition_check
  type: race_condition
  target: /api/coupon
  method: POST
  config: {body: {coupon: "FREE"}}

- id: otp_reuse_check
  type: otp_reuse
  target: /api/verify
  method: POST
  config: {otp: "123456"}

# --- 7. SERVER SIDE REQUEST FORGERY ---
- id: ssrf_webhook_check
  type: ssrf
  target: /api/webhook
  method: POST
  config: {fields: [url, callback, webhook]}

# --- 8. DENIAL OF SERVICE (EXTREME) ---
- id: slowloris_dos
  type: slowloris
  target: /
  method: GET
  config: 
    sockets: 100
    duration: 10
    # Aggressive Mode triggers: Higher concurrency automatically via Engine scaling
