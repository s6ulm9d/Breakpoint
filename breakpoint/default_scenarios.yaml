# ==========================================
# BREAKPOINT ELITE SCENARIOS (FULL SPECTRUM)
# ==========================================
# Modes:
# - Normal: Standard vulnerability checks (Non-destructive)
# - Aggressive: Destructive payloads, Higher concurrency, Crashing (Use --aggressive CLI flag)
# ==========================================

# --- 1. RECONNAISSANCE & MISCONFIGURATION ---
- id: check_security_headers
  type: header_security
  target: /
  method: GET

- id: check_open_redirect
  type: open_redirect
  target: /redirect
  method: GET
  config: {fields: [url, next, returnTo, callback, undo]}

- id: check_debug_exposure
  type: debug_exposure
  target: /
  method: GET

- id: check_secret_leak
  type: secret_leak
  target: /
  method: GET

# --- 2. IDENTIFICATION & AUTHENTICATION ---
- id: brute_force_login
  type: brute_force
  target: /login
  method: POST
  config: 
    user: admin
    # Aggressive Mode triggers: Large dictionary & Buffer Overflows

- id: jwt_none_algo_attack
  type: jwt_weakness
  target: /api/user
  method: GET
  config: {token: "{{token}}"} 
  # Note: Requires a captured token. If missing, this test skips safely.

# --- 3. INJECTION (THE HEAVY HITTERS) ---
- id: sql_injection_login
  type: sql_injection
  target: /login
  method: POST
  config: 
    fields: [username, password, email]
    # Aggressive Mode triggers: DROP TABLE, TRUNCATE, xp_cmdshell

- id: xss_reflected_search
  type: xss
  target: /search
  method: GET
  config: {fields: [q, query, search, keyword]}

- id: crlf_injection_headers
  type: crlf_injection
  target: /
  method: GET
  config: {fields: [lang, url]}
  
- id: command_injection_rce
  type: rce
  target: /api/ping
  method: POST
  config: {fields: [ip, host, domain, target]}

- id: xxe_xml_injection
  type: xxe_exfil
  target: /api/xml
  method: POST

- id: ssti_template_injection
  type: ssti
  target: /template
  method: GET
  config: {fields: [name, template, text]}
  
- id: insecure_deserialization
  type: insecure_deserialization
  target: /
  method: GET
  # Checks Cookies for Java/Python serialized objects

# --- 4. BROKEN ACCESS CONTROL ---
- id: idor_check
  type: idor
  target: /api/users/{{id}}
  method: GET
  config: {test_ids: [1, 2, 3, 100, 101, 999]}

- id: lfi_path_traversal
  type: lfi
  target: /download
  method: GET
  config: {fields: [file, path, doc, view]}

# --- 5. VULNERABLE COMPONENTS (CVEs) ---
- id: log4shell_check
  type: log4shell
  target: /
  method: GET
  # Aggressive Mode triggers: Remote Shell Execution attempts

- id: spring4shell_check
  type: spring4shell
  target: /
  method: POST
  # Attempts to drop a webshell

- id: struts2_rce_check
  type: struts2_rce
  target: /
  method: GET

# --- 6. LOGIC & BUSINESS FLAWS ---
- id: race_condition_check
  type: race_condition
  target: /api/coupon
  method: POST
  config: {body: {coupon: "FREE"}}

- id: otp_reuse_check
  type: otp_reuse
  target: /api/verify
  method: POST
  config: {otp: "123456"}

# --- 7. SERVER SIDE REQUEST FORGERY ---
- id: ssrf_webhook_check
  type: ssrf
  target: /api/webhook
  method: POST
  config: {fields: [url, callback, webhook]}

# --- 8. ADVANCED ATTACKS (RSC & Modern Web) ---
- id: cache_poisoning_check
  type: rsc_cache_poisoning
  target: /
  method: GET
  config: {headers: ["X-Forwarded-Host", "X-Host", "X-Forwarded-Server"]}

- id: web_cache_deception
  type: cache_deception
  target: /profile
  method: GET
  
- id: http_request_smuggling
  type: request_smuggling
  target: /
  method: POST
  
- id: server_side_action_forge
  type: rsc_server_action_forge
  target: /_next/data
  method: POST
  
- id: hydration_collapse
  type: rsc_hydration_collapse
  target: /
  method: GET
  
- id: trust_boundary_violation
  type: rsc_flight_trust_boundary_violation
  target: /api/flight
  method: POST
  
- id: react_server_component_injection
  type: rsc_flight_deserialization_abuse
  target: /
  method: POST

- id: graphql_introspection
  type: graphql_introspection
  target: /graphql
  method: POST
  
- id: graphql_batching_dos
  type: graphql_batching
  target: /graphql
  method: POST

- id: nosql_injection_login
  type: nosql_injection
  target: /login
  method: POST
  config: {fields: [username, password]}

- id: ldap_injection_search
  type: ldap_injection
  target: /directory
  method: GET
  config: {fields: [user, cn, mail]}

- id: xpath_injection_xml
  type: xpath_injection
  target: /api/soap
  method: POST
  config: {fields: [query, id]}

- id: ssi_injection
  type: ssi_injection
  target: /
  method: GET
  config: {fields: [input]}

- id: shellshock_legacy
  type: shellshock
  target: /cgi-bin/test
  method: GET

- id: clickjacking_check
  type: clickjacking
  target: /
  method: GET

- id: cors_misconfiguration
  type: cors_origin
  target: /api/data
  method: GET

- id: host_header_injection
  type: host_header
  target: /
  method: GET

- id: email_header_injection
  type: email_injection
  target: /contact
  method: POST
  config: {fields: [email, subject]}

- id: jwt_weak_key_brute
  type: jwt_brute
  target: /api/auth
  method: GET
  
- id: swagger_ui_exposure
  type: swagger_exposure
  target: /swagger-ui.html
  method: GET
  
- id: git_exposure_check
  type: git_exposure
  target: /.git/HEAD
  method: GET
  
- id: env_exposure_check
  type: env_exposure
  target: /.env
  method: GET
  
- id: phpinfo_exposure
  type: phpinfo
  target: /phpinfo.php
  method: GET
  
- id: ds_store_exposure
  type: ds_store_exposure
  target: /.DS_Store
  method: GET

# --- 8. DENIAL OF SERVICE (EXTREME) ---
- id: slowloris_dos
  type: slowloris
  target: /
  method: GET
  config: 
    sockets: 100
    duration: 10
    # Aggressive Mode triggers: Higher concurrency automatically via Engine scaling
